<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>School Tools Platform</title>
  <style>
    /* General Styles */
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f9fafb;
    }

    /* Hide all sections by default */
    .feature-section {
      display: none;
      padding: 20px;
    }

    /* Login/Register Styles */
    .auth-container {
      max-width: 400px;
      margin: 100px auto;
      padding: 30px;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .auth-container h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    .auth-container form {
      display: flex;
      flex-direction: column;
    }

    .auth-container form input {
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .auth-container form button {
      padding: 10px;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .auth-container form button:hover {
      background-color: #0056b3;
    }

    .toggle-link {
      text-align: center;
      margin-top: 10px;
      color: #007BFF;
      cursor: pointer;
    }

    .toggle-link:hover {
      text-decoration: underline;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 250px;
      background-color: #007BFF;
      color: white;
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      padding-top: 20px;
      display: none; /* Hidden by default, shown after login */
    }

    .sidebar h2 {
      text-align: center;
      margin-bottom: 30px;
    }

    .sidebar a {
      display: block;
      color: white;
      padding: 15px 20px;
      text-decoration: none;
      margin-bottom: 5px;
      transition: background 0.3s;
    }

    .sidebar a:hover {
      background-color: #0056b3;
    }

    .logout-btn {
      background-color: #dc3545;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 20px;
      width: calc(100% - 40px);
    }

    .logout-btn:hover {
      background-color: #c82333;
    }

    /* Main Content Styles */
    .main-content {
      margin-left: 250px;
      padding: 40px;
      flex-grow: 1;
      display: none; /* Hidden by default, shown after login */
    }

    /* Task Manager Styles */
    .task-manager {
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .task-form {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .task-form input, .task-form select {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-right: 10px;
      flex: 1 1 200px;
      margin-bottom: 10px;
    }

    .task-form button {
      padding: 10px 20px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      flex: 1 1 100px;
    }

    .task-form button:hover {
      background-color: #218838;
    }

    .task-list {
      list-style: none;
      padding: 0;
    }

    .task-item {
      background-color: #f9f9f9;
      padding: 15px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    .task-item.completed {
      text-decoration: line-through;
      background-color: #d4edda;
    }

    .task-item button {
      padding: 5px 10px;
      border: none;
      cursor: pointer;
      border-radius: 4px;
      margin-left: 5px;
      margin-top: 5px;
    }

    .complete-btn {
      background-color: #007bff;
      color: white;
    }

    .delete-btn {
      background-color: #dc3545;
      color: white;
    }

    .filter-bar {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .filter-bar select {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      flex: 1 1 200px;
      margin-bottom: 10px;
    }

    /* Worksheet, Quiz Generator, and Tech Updates Styles */
    .feature-section {
      display: none;
      margin-top: 50px;
    }

    .feature-section form {
      display: flex;
      flex-direction: column;
    }

    .feature-section form label {
      margin: 10px 0 5px;
    }

    .feature-section form input, .feature-section form select, .feature-section form button {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 15px;
    }

    .feature-section form button {
      background-color: #007BFF;
      color: white;
      cursor: pointer;
    }

    .feature-section form button:hover {
      background-color: #0056b3;
    }

    /* Quiz Styles */
    .quiz-question {
      margin-bottom: 20px;
    }

    .quiz-options label {
      display: block;
      margin-bottom: 10px;
      cursor: pointer;
    }

    .quiz-submit {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
    }

    .quiz-submit:hover {
      background-color: #218838;
    }

    /* Generated Content Styles */
    #generatedWorksheet, #quizArea, #updateMessage {
      margin-top: 20px;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    /* Responsive Styles */
    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }
      .main-content {
        margin-left: 0;
      }
    }
  </style>
</head>
<body>

  <!-- Authentication Container -->
  <div id="auth-container" class="auth-container">
    <h2 id="auth-title">Login</h2>
    <form id="auth-form">
      <input type="text" id="username" placeholder="Username" required>
      <input type="password" id="password" placeholder="Password" required>
      <button type="submit" id="auth-button">Login</button>
    </form>
    <div class="toggle-link" id="toggle-link">Don't have an account? Register here.</div>
  </div>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <h2>Dashboard</h2>
    <a href="#" onclick="showSection('task-manager')">Task Manager</a>
    <a href="#" onclick="showFutureFeature()">Backup & Restore</a>
    <a href="#" onclick="showFutureFeature()">Themes</a>
    <a href="#" onclick="showFutureFeature()">Notes</a>
    <a href="#" onclick="showFutureFeature()">Shared Tasks</a>
    <a href="#" onclick="showSection('worksheet-generator')">Worksheet Generator</a>
    <a href="#" onclick="showSection('quiz-generator')">Quiz Generator</a>
    <a href="#" onclick="showSection('tech-updates')">Tech Updates</a>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>

  <!-- Main Content -->
  <div class="main-content" id="main-content">

    <!-- Task Manager Feature -->
    <div id="task-manager" class="feature-section">
      <h2>Task Manager</h2>
      <div class="task-manager">
        <h3>Manage Your Tasks</h3>
        <!-- Task Form -->
        <div class="task-form">
          <input type="text" id="taskName" placeholder="Task Name" required>
          <input type="text" id="taskDesc" placeholder="Task Description">
          <select id="taskPriority">
            <option value="low">Low Priority</option>
            <option value="medium">Medium Priority</option>
            <option value="high">High Priority</option>
          </select>
          <button onclick="addTask()">Add Task</button>
        </div>

        <!-- Filter Bar -->
        <div class="filter-bar">
          <select id="filterStatus" onchange="filterTasks()">
            <option value="all">All Tasks</option>
            <option value="completed">Completed Tasks</option>
            <option value="incomplete">Incomplete Tasks</option>
          </select>
          <select id="filterPriority" onchange="filterTasks()">
            <option value="all">All Priorities</option>
            <option value="low">Low Priority</option>
            <option value="medium">Medium Priority</option>
            <option value="high">High Priority</option>
          </select>
        </div>

        <!-- Task List -->
        <ul id="taskList" class="task-list">
          <!-- Task Items will appear here -->
        </ul>
      </div>
    </div>

    <!-- Worksheet Generator Section -->
    <div id="worksheet-generator" class="feature-section">
      <h2>Worksheet Generator</h2>
      <p>Select your preferences and generate a worksheet with random questions:</p>
      
      <form id="worksheetForm">
        <label for="subject">Choose Subject:</label>
        <select id="subject" name="subject" required>
          <option value="math">Math</option>
          <option value="science">Science</option>
        </select>
        
        <label for="numQuestions">Number of Questions:</label>
        <input type="number" id="numQuestions" name="numQuestions" min="5" max="50" required>
        
        <label for="difficulty">Difficulty Level:</label>
        <select id="difficulty" name="difficulty" required>
          <option value="easy">Easy</option>
          <option value="medium">Medium</option>
          <option value="hard">Hard</option>
        </select>

        <label for="questionType">Question Type:</label>
        <select id="questionType" name="questionType" required>
          <option value="mcq">Multiple Choice</option>
          <option value="shortAnswer">Short Answer</option>
          <option value="longAnswer">Long Answer</option>
        </select>
        
        <button type="button" onclick="generateWorksheet()">Generate Worksheet</button>
      </form>

      <div id="generatedWorksheet"></div>
    </div>

    <!-- Quiz Generator Section -->
    <div id="quiz-generator" class="feature-section">
      <h2>Quiz Generator</h2>
      <p>Select your preferences and take a quiz:</p>
      
      <form id="quizForm">
        <label for="quizSubject">Choose Subject:</label>
        <select id="quizSubject" name="quizSubject" required>
          <option value="math">Math</option>
          <option value="science">Science</option>
        </select>
        
        <label for="quizNumQuestions">Number of Questions:</label>
        <input type="number" id="quizNumQuestions" name="quizNumQuestions" min="5" max="20" required>

        <button type="button" onclick="startQuiz()">Start Quiz</button>
      </form>

      <div id="quizArea"></div>
    </div>

    <!-- Tech Updates Section -->
    <div id="tech-updates" class="feature-section">
      <h2>Tech Updates</h2>
      <button onclick="showUpdate()">Check for Updates</button>
      <div id="updateMessage"></div>
    </div>

  </div>

  <script>
    // Authentication Functions
    const authContainer = document.getElementById('auth-container');
    const authForm = document.getElementById('auth-form');
    const authTitle = document.getElementById('auth-title');
    const authButton = document.getElementById('auth-button');
    const toggleLink = document.getElementById('toggle-link');
    let isLogin = true;

    // Toggle between Login and Register
    toggleLink.addEventListener('click', () => {
      isLogin = !isLogin;
      if (isLogin) {
        authTitle.textContent = 'Login';
        authButton.textContent = 'Login';
        toggleLink.textContent = "Don't have an account? Register here.";
      } else {
        authTitle.textContent = 'Register';
        authButton.textContent = 'Register';
        toggleLink.textContent = "Already have an account? Login here.";
      }
    });

    // Handle Authentication
    authForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();

      if (isLogin) {
        // Login Process
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const user = users.find(u => u.username === username && u.password === password);
        if (user) {
          localStorage.setItem('loggedInUser', JSON.stringify(user));
          showApp();
        } else {
          alert('Invalid username or password.');
        }
      } else {
        // Registration Process
        let users = JSON.parse(localStorage.getItem('users')) || [];
        const userExists = users.some(u => u.username === username);
        if (userExists) {
          alert('Username already exists. Please choose another one.');
        } else {
          const newUser = { username, password };
          users.push(newUser);
          localStorage.setItem('users', JSON.stringify(users));
          alert('Registration successful! You can now log in.');
          isLogin = true;
          authTitle.textContent = 'Login';
          authButton.textContent = 'Login';
          toggleLink.textContent = "Don't have an account? Register here.";
        }
      }
    });

    // Show App After Login
    function showApp() {
      authContainer.style.display = 'none';
      document.getElementById('sidebar').style.display = 'block';
      document.getElementById('main-content').style.display = 'block';
      showSection('task-manager'); // Show Task Manager by default
      initTaskManager();
    }

    // Check if User is Already Logged In
    window.onload = function() {
      const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
      if (loggedInUser) {
        showApp();
      } else {
        authContainer.style.display = 'block';
        document.getElementById('sidebar').style.display = 'none';
        document.getElementById('main-content').style.display = 'none';
      }
    }

    // Logout Function
    function logout() {
      localStorage.removeItem('loggedInUser');
      location.reload();
    }

    // Utility Function to Show Sections
    function showSection(sectionId) {
      const sections = document.querySelectorAll('.feature-section');
      sections.forEach(section => section.style.display = 'none');
      document.getElementById(sectionId).style.display = 'block';
    }

    function showFutureFeature() {
      alert("This feature will be implemented in future updates.");
    }

    // =======================
    // Task Manager Functions
    // =======================
    let tasks = [];

    // Load tasks from localStorage
    function loadTasks() {
      const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
      if (loggedInUser) {
        const userTasks = JSON.parse(localStorage.getItem(`${loggedInUser.username}_tasks`)) || [];
        tasks = userTasks;
      }
    }

    // Save tasks to localStorage
    function saveTasks() {
      const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
      if (loggedInUser) {
        localStorage.setItem(`${loggedInUser.username}_tasks`, JSON.stringify(tasks));
      }
    }

    function addTask() {
      const taskName = document.getElementById('taskName').value.trim();
      const taskDesc = document.getElementById('taskDesc').value.trim();
      const taskPriority = document.getElementById('taskPriority').value;

      if (taskName) {
        const task = {
          name: taskName,
          desc: taskDesc,
          priority: taskPriority,
          completed: false
        };
        tasks.push(task);
        saveTasks();
        renderTasks();
        document.getElementById('taskName').value = '';
        document.getElementById('taskDesc').value = '';
      } else {
        alert('Task name is required.');
      }
    }

    function renderTasks() {
      const taskList = document.getElementById('taskList');
      taskList.innerHTML = '';

      const filterStatus = document.getElementById('filterStatus').value;
      const filterPriority = document.getElementById('filterPriority').value;

      const filteredTasks = tasks.filter(task => {
        const statusMatch = filterStatus === 'all' ||
          (filterStatus === 'completed' && task.completed) ||
          (filterStatus === 'incomplete' && !task.completed);
        const priorityMatch = filterPriority === 'all' || task.priority === filterPriority;
        return statusMatch && priorityMatch;
      });

      filteredTasks.forEach((task, index) => {
        const taskItem = document.createElement('li');
        taskItem.classList.add('task-item');
        if (task.completed) {
          taskItem.classList.add('completed');
        }
        taskItem.innerHTML = `
          <div>
            <strong>${sanitize(task.name)}</strong> - ${sanitize(task.desc)} - <em>${sanitize(task.priority)}</em>
          </div>
          <div>
            <button class="complete-btn" onclick="toggleTaskComplete(${index})">${task.completed ? 'Undo' : 'Complete'}</button>
            <button class="delete-btn" onclick="deleteTask(${index})">Delete</button>
          </div>
        `;
        taskList.appendChild(taskItem);
      });
    }

    function toggleTaskComplete(index) {
      tasks[index].completed = !tasks[index].completed;
      saveTasks();
      renderTasks();
    }

    function deleteTask(index) {
      if (confirm('Are you sure you want to delete this task?')) {
        tasks.splice(index, 1);
        saveTasks();
        renderTasks();
      }
    }

    function filterTasks() {
      renderTasks();
    }

    function sanitize(input) {
      const div = document.createElement('div');
      div.textContent = input;
      return div.innerHTML;
    }

    // Initialize Task Manager
    function initTaskManager() {
      loadTasks();
      renderTasks();
    }

    // ================================
    // Worksheet Generator Functions
    // ================================
    const questionBank = {
      math: {
        easy: [
          "What is 2 + 2?",
          "What is 5 - 3?",
          "What is 3 × 4?",
          "What is 10 ÷ 2?",
          "What is the square of 3?"
        ],
        medium: [
          "Solve for x: 2x + 5 = 13.",
          "What is the area of a triangle with base 5 and height 10?",
          "Simplify: (3²) + (4²).",
          "What is the perimeter of a rectangle with length 8 and width 5?",
          "Find the value of 15% of 200."
        ],
        hard: [
          "Integrate the function f(x) = 3x².",
          "Solve the equation: x³ - 6x² + 11x - 6 = 0.",
          "What is the derivative of sin(x)?",
          "Calculate the limit: lim(x→0) (sin(x)/x).",
          "What is the solution to the differential equation dy/dx = 2x?"
        ]
      },
      science: {
        easy: [
          "What is the chemical symbol for water?",
          "What planet is known as the Red Planet?",
          "What gas do plants absorb from the atmosphere?",
          "What is H₂O commonly known as?",
          "What force keeps us grounded on Earth?"
        ],
        medium: [
          "What is the powerhouse of the cell?",
          "What is the chemical formula for table salt?",
          "Define Newton's Second Law of Motion.",
          "What is the process by which plants make their food?",
          "Name the three states of matter."
        ],
        hard: [
          "Explain the theory of relativity.",
          "What is the Heisenberg Uncertainty Principle?",
          "Describe the process of nuclear fusion.",
          "What is the significance of the Pauli Exclusion Principle?",
          "Define Schrödinger's Cat paradox."
        ]
      }
    };

    function generateWorksheet() {
      const subject = document.getElementById('subject').value;
      const numQuestions = parseInt(document.getElementById('numQuestions').value);
      const difficulty = document.getElementById('difficulty').value;
      const questionType = document.getElementById('questionType').value;

      const availableQuestions = questionBank[subject][difficulty];
      if (!availableQuestions) {
        alert('No questions available for the selected options.');
        return;
      }

      if (numQuestions > availableQuestions.length) {
        alert(`Only ${availableQuestions.length} questions available for ${subject} (${difficulty} difficulty).`);
        return;
      }

      const selectedQuestions = shuffleArray(availableQuestions).slice(0, numQuestions);
      let worksheetContent = `<h3>Generated Worksheet for ${capitalize(subject)}</h3><ol>`;
      
      selectedQuestions.forEach((q, index) => {
        worksheetContent += `<li>${q}</li>`;
      });
      worksheetContent += `</ol>`;

      document.getElementById('generatedWorksheet').innerHTML = worksheetContent;
    }

    // Utility function to shuffle an array
    function shuffleArray(array) {
      let currentIndex = array.length, temporaryValue, randomIndex;

      // While there remain elements to shuffle...
      while (0 !== currentIndex) {

        // Pick a remaining element...
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex -= 1;

        // And swap it with the current element.
        temporaryValue = array[currentIndex];
        array[currentIndex] = array[randomIndex];
        array[randomIndex] = temporaryValue;
      }

      return array;
    }

    // Capitalize first letter
    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    // ==========================
    // Quiz Generator Functions
    // ==========================
    let currentQuiz = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let userAnswers = [];

    // Define correct answers for each question
    const correctAnswers = {
      math: {
        easy: {
          "What is 2 + 2?": "4",
          "What is 5 - 3?": "2",
          "What is 3 × 4?": "12",
          "What is 10 ÷ 2?": "5",
          "What is the square of 3?": "9"
        },
        medium: {
          "Solve for x: 2x + 5 = 13.": "4",
          "What is the area of a triangle with base 5 and height 10?": "25",
          "Simplify: (3²) + (4²).": "25",
          "What is the perimeter of a rectangle with length 8 and width 5?": "26",
          "Find the value of 15% of 200.": "30"
        },
        hard: {
          "Integrate the function f(x) = 3x².": "x³ + C",
          "Solve the equation: x³ - 6x² + 11x - 6 = 0.": "1, 2, 3",
          "What is the derivative of sin(x)?": "cos(x)",
          "Calculate the limit: lim(x→0) (sin(x)/x).": "1",
          "What is the solution to the differential equation dy/dx = 2x?": "y = x² + C"
        }
      },
      science: {
        easy: {
          "What is the chemical symbol for water?": "H₂O",
          "What planet is known as the Red Planet?": "Mars",
          "What gas do plants absorb from the atmosphere?": "Carbon Dioxide",
          "What is H₂O commonly known as?": "Water",
          "What force keeps us grounded on Earth?": "Gravity"
        },
        medium: {
          "What is the powerhouse of the cell?": "Mitochondria",
          "What is the chemical formula for table salt?": "NaCl",
          "Define Newton's Second Law of Motion.": "Force equals mass times acceleration (F=ma)",
          "What is the process by which plants make their food?": "Photosynthesis",
          "Name the three states of matter.": "Solid, Liquid, Gas"
        },
        hard: {
          "Explain the theory of relativity.": "A theory by Einstein that describes the laws of physics in the presence of gravitational fields and high velocities.",
          "What is the Heisenberg Uncertainty Principle?": "It states that the position and momentum of a particle cannot both be precisely determined simultaneously.",
          "Describe the process of nuclear fusion.": "Combining two light atomic nuclei to form a heavier nucleus, releasing energy.",
          "What is the significance of the Pauli Exclusion Principle?": "No two fermions can occupy the same quantum state simultaneously.",
          "Define Schrödinger's Cat paradox.": "A thought experiment that illustrates the concept of superposition in quantum mechanics."
        }
      }
    };

    function startQuiz() {
      const subject = document.getElementById('quizSubject').value;
      const numQuestions = parseInt(document.getElementById('quizNumQuestions').value);

      const difficulty = 'medium'; // Fixed difficulty for quizzes; can be made dynamic if desired
      const availableQuestions = Object.keys(correctAnswers[subject][difficulty]);
      if (!availableQuestions) {
        alert('No questions available for the selected options.');
        return;
      }

      if (numQuestions > availableQuestions.length) {
        alert(`Only ${availableQuestions.length} questions available for ${subject} (medium difficulty).`);
        return;
      }

      currentQuiz = shuffleArray(availableQuestions).slice(0, numQuestions);
      currentQuestionIndex = 0;
      score = 0;
      userAnswers = [];
      document.getElementById('quizArea').innerHTML = '';
      displayQuizQuestion();
    }

    function displayQuizQuestion() {
      if (currentQuestionIndex < currentQuiz.length) {
        const question = currentQuiz[currentQuestionIndex];
        const quizArea = document.getElementById('quizArea');

        // Generate multiple choice options if question type is MCQ
        const isMCQ = question.includes("What") || question.includes("Define") || question.includes("Explain");
        let optionsHTML = '';
        let correctAnswer = correctAnswers[getCurrentQuizSubject()][getCurrentQuizDifficulty()][question];
        let options = [];

        if (isMCQ) {
          // Generate random options
          options = generateMCQOptions(correctAnswer);
          optionsHTML = options.map((opt, idx) => `
            <input type="radio" id="option${idx+1}" name="answer" value="${opt}">
            <label for="option${idx+1}">${opt}</label>
          `).join('');
        } else {
          // Short or long answer
          optionsHTML = `<input type="text" id="answerInput" placeholder="Type your answer here">`;
        }

        quizArea.innerHTML = `
          <div class="quiz-question">
            <strong>Question ${currentQuestionIndex + 1}:</strong> ${sanitize(question)}
          </div>
          <div class="quiz-options">
            ${optionsHTML}
          </div>
          <button class="quiz-submit" onclick="submitQuizAnswer()">Submit Answer</button>
        `;
      } else {
        displayQuizResult();
      }
    }

    function generateMCQOptions(correctAnswer) {
      const dummyOptions = generateDummyOptions(correctAnswer);
      dummyOptions.push(correctAnswer);
      return shuffleArray(dummyOptions).slice(0, 4);
    }

    function generateDummyOptions(correctAnswer) {
      let options = [];
      for (let i = 0; i < 3; i++) {
        let option;
        do {
          option = generateRandomOption(correctAnswer);
        } while (options.includes(option) || option === correctAnswer);
        options.push(option);
      }
      return options;
    }

    function generateRandomOption(correctAnswer) {
      // Simple random option generator; can be improved based on subject and type
      const randomNumber = Math.floor(Math.random() * 100) + 1;
      return randomNumber.toString();
    }

    function submitQuizAnswer() {
      const subject = getCurrentQuizSubject();
      const difficulty = getCurrentQuizDifficulty();
      const question = currentQuiz[currentQuestionIndex];
      const correctAnswer = correctAnswers[subject][difficulty][question];

      let userAnswer = '';
      const selectedOption = document.querySelector('input[name="answer"]:checked');
      if (selectedOption) {
        userAnswer = selectedOption.value.trim();
      } else {
        const textInput = document.getElementById('answerInput');
        if (textInput) {
          userAnswer = textInput.value.trim();
        }
      }

      if (userAnswer === '') {
        alert('Please provide an answer.');
        return;
      }

      userAnswers.push(userAnswer);

      // Normalize answers for comparison
      const normalizedUserAnswer = userAnswer.toLowerCase();
      const normalizedCorrectAnswer = correctAnswer.toLowerCase();

      if (normalizedUserAnswer === normalizedCorrectAnswer) {
        score += 1;
      }

      currentQuestionIndex += 1;
      displayQuizQuestion();
    }

    function displayQuizResult() {
      const quizArea = document.getElementById('quizArea');
      quizArea.innerHTML = `
        <h3>Quiz Completed!</h3>
        <p>Your Score: ${score} out of ${currentQuiz.length}</p>
        <button onclick="reviewQuiz()">Review Answers</button>
      `;
    }

    function reviewQuiz() {
      const quizArea = document.getElementById('quizArea');
      let reviewContent = `<h3>Quiz Review</h3><ol>`;
      for (let i = 0; i < currentQuiz.length; i++) {
        const question = currentQuiz[i];
        const userAnswer = userAnswers[i];
        const correctAnswer = correctAnswers[getCurrentQuizSubject()][getCurrentQuizDifficulty()][question];
        reviewContent += `
          <li>
            <strong>${sanitize(question)}</strong><br>
            Your Answer: ${sanitize(userAnswer)}<br>
            Correct Answer: ${sanitize(correctAnswer)}<br>
            ${userAnswer.toLowerCase() === correctAnswer.toLowerCase() ? '<span style="color:green;">Correct</span>' : '<span style="color:red;">Incorrect</span>'}
          </li>
        `;
      }
      reviewContent += `</ol>`;
      quizArea.innerHTML = reviewContent;
    }

    function getCurrentQuizSubject() {
      return document.getElementById('quizSubject').value;
    }

    function getCurrentQuizDifficulty() {
      return 'medium'; // Fixed difficulty; modify if needed
    }

    // =====================
    // Tech Updates Function
    // =====================
    function showUpdate() {
      document.getElementById('updateMessage').innerHTML = "As a lazy dev, I am working on it and will share a new update soon!";
    }

    // =====================
    // Initialization
    // =====================
    window.onload = function() {
      const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
      if (loggedInUser) {
        showApp();
        initTaskManager();
      }
    }
  </script>

</body>
</html>
